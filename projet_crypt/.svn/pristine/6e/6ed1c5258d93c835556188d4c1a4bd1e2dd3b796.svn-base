<?xml version="1.0"?>
<!DOCTYPE refentry PUBLIC "-//OASIS//DTD DocBook XML V4.3//EN"
               "http://www.oasis-open.org/docbook/xml/4.3/docbookx.dtd"
[
  <!ENTITY version SYSTEM "version.xml">
]>
<refentry id="GUdevClient">
<refmeta>
<refentrytitle role="top_of_page" id="GUdevClient.top_of_page">GUdevClient</refentrytitle>
<manvolnum>3</manvolnum>
<refmiscinfo>
  GUDEV Library
</refmiscinfo>
</refmeta>
<refnamediv>
<refname>GUdevClient</refname>
<refpurpose>Query devices and listen to uevents</refpurpose>
</refnamediv>

<refsynopsisdiv id="GUdevClient.synopsis" role="synopsis">
<title role="synopsis.title">Synopsis</title>
<anchor id="GUdevDeviceType"/>
<synopsis>                    <link linkend="GUdevClient-struct">GUdevClient</link>;
struct              <link linkend="GUdevClientClass">GUdevClientClass</link>;
enum                <link linkend="GUdevDeviceType-enum">GUdevDeviceType</link>;
typedef             <link linkend="GUdevDeviceNumber">GUdevDeviceNumber</link>;
<link linkend="GUdevClient"><returnvalue>GUdevClient</returnvalue></link> *       <link linkend="g-udev-client-new">g_udev_client_new</link>                   (<parameter>const <link linkend="gchar"><type>gchar</type></link> * const *subsystems</parameter>);
<link linkend="GList"><returnvalue>GList</returnvalue></link> *             <link linkend="g-udev-client-query-by-subsystem">g_udev_client_query_by_subsystem</link>    (<parameter><link linkend="GUdevClient"><type>GUdevClient</type></link> *client</parameter>,
                                                         <parameter>const <link linkend="gchar"><type>gchar</type></link> *subsystem</parameter>);
<link linkend="GUdevDevice"><returnvalue>GUdevDevice</returnvalue></link> *       <link linkend="g-udev-client-query-by-device-number">g_udev_client_query_by_device_number</link>
                                                        (<parameter><link linkend="GUdevClient"><type>GUdevClient</type></link> *client</parameter>,
                                                         <parameter><link linkend="GUdevDeviceType"><type>GUdevDeviceType</type></link> type</parameter>,
                                                         <parameter><link linkend="GUdevDeviceNumber"><type>GUdevDeviceNumber</type></link> number</parameter>);
<link linkend="GUdevDevice"><returnvalue>GUdevDevice</returnvalue></link> *       <link linkend="g-udev-client-query-by-device-file">g_udev_client_query_by_device_file</link>  (<parameter><link linkend="GUdevClient"><type>GUdevClient</type></link> *client</parameter>,
                                                         <parameter>const <link linkend="gchar"><type>gchar</type></link> *device_file</parameter>);
<link linkend="GUdevDevice"><returnvalue>GUdevDevice</returnvalue></link> *       <link linkend="g-udev-client-query-by-sysfs-path">g_udev_client_query_by_sysfs_path</link>   (<parameter><link linkend="GUdevClient"><type>GUdevClient</type></link> *client</parameter>,
                                                         <parameter>const <link linkend="gchar"><type>gchar</type></link> *sysfs_path</parameter>);
<link linkend="GUdevDevice"><returnvalue>GUdevDevice</returnvalue></link> *       <link linkend="g-udev-client-query-by-subsystem-and-name">g_udev_client_query_by_subsystem_and_name</link>
                                                        (<parameter><link linkend="GUdevClient"><type>GUdevClient</type></link> *client</parameter>,
                                                         <parameter>const <link linkend="gchar"><type>gchar</type></link> *subsystem</parameter>,
                                                         <parameter>const <link linkend="gchar"><type>gchar</type></link> *name</parameter>);
</synopsis>
</refsynopsisdiv>
<refsect1 id="GUdevClient.object-hierarchy" role="object_hierarchy">
<title role="object_hierarchy.title">Object Hierarchy</title>
<synopsis>
  <link linkend="GObject">GObject</link>
   +----GUdevClient
</synopsis>
<synopsis>
  <link linkend="GEnum">GEnum</link>
   +----GUdevDeviceType
</synopsis>

</refsect1>
<refsect1 id="GUdevClient.properties" role="properties">
<title role="properties.title">Properties</title>
<synopsis>
  &quot;<link linkend="GUdevClient--subsystems">subsystems</link>&quot;               <link linkend="GStrv"><type>GStrv</type></link>                 : Read / Write / Construct Only
</synopsis>
</refsect1>
<refsect1 id="GUdevClient.signals" role="signal_proto">
<title role="signal_proto.title">Signals</title>
<synopsis>
  &quot;<link linkend="GUdevClient-uevent">uevent</link>&quot;                                         : <link linkend="G-SIGNAL-RUN-LAST:CAPS"><literal>Run Last</literal></link>
</synopsis>
</refsect1>

<refsect1 id="GUdevClient.description" role="desc">
<title role="desc.title">Description</title>
<para>
<link linkend="GUdevClient"><type>GUdevClient</type></link> is used to query information about devices on a Linux
system from the Linux kernel and the udev device
manager.
</para>
<para>
Device information is retrieved from the kernel (through the
<literal>sysfs</literal> filesystem) and the udev daemon (through a
<literal>tmpfs</literal> filesystem) and presented through
<link linkend="GUdevDevice"><type>GUdevDevice</type></link> objects. This means that no blocking IO ever happens
(in both cases, we are essentially just reading data from kernel
memory) and as such there are no asynchronous versions of the
provided methods.
</para>
<para>
To get <link linkend="GUdevDevice"><type>GUdevDevice</type></link> objects, use
<link linkend="g-udev-client-query-by-subsystem"><function>g_udev_client_query_by_subsystem()</function></link>,
<link linkend="g-udev-client-query-by-device-number"><function>g_udev_client_query_by_device_number()</function></link>,
<link linkend="g-udev-client-query-by-device-file"><function>g_udev_client_query_by_device_file()</function></link>,
<link linkend="g-udev-client-query-by-sysfs-path"><function>g_udev_client_query_by_sysfs_path()</function></link>,
<link linkend="g-udev-client-query-by-subsystem-and-name"><function>g_udev_client_query_by_subsystem_and_name()</function></link>
or the <link linkend="GUdevEnumerator"><type>GUdevEnumerator</type></link> type.
</para>
<para>
To listen to uevents, connect to the <link linkend="GUdevClient-uevent"><type>"uevent"</type></link> signal.
</para>
</refsect1>
<refsect1 id="GUdevClient.details" role="details">
<title role="details.title">Details</title>
<refsect2 id="GUdevClient-struct" role="struct">
<title>GUdevClient</title>
<indexterm zone="GUdevClient-struct"><primary>GUdevClient</primary></indexterm>
<programlisting>typedef struct _GUdevClient GUdevClient;</programlisting>
<para>
The <link linkend="GUdevClient"><type>GUdevClient</type></link> struct is opaque and should not be accessed directly.
</para></refsect2>
<refsect2 id="GUdevClientClass" role="struct">
<title>struct GUdevClientClass</title>
<indexterm zone="GUdevClientClass"><primary>GUdevClientClass</primary></indexterm>
<programlisting>struct GUdevClientClass {
  GObjectClass   parent_class;

  /* signals */
  void (*uevent) (GUdevClient  *client,
                  const gchar  *action,
                  GUdevDevice  *device);
};
</programlisting>
<para>
Class structure for <link linkend="GUdevClient"><type>GUdevClient</type></link>.
</para><variablelist role="struct">
<varlistentry><term><link linkend="GObjectClass"><type>GObjectClass</type></link>&#160;<structfield id="GUdevClientClass.parent-class">parent_class</structfield>;</term>
<listitem><simpara>Parent class.</simpara></listitem>
</varlistentry>
<varlistentry><term><structfield id="GUdevClientClass.uevent">uevent</structfield>&#160;()</term>
<listitem><simpara>Signal class handler for the <link linkend="GUdevClient-uevent"><type>"uevent"</type></link> signal.</simpara></listitem>
</varlistentry>
</variablelist></refsect2>
<refsect2 id="GUdevDeviceType-enum" role="enum">
<title>enum GUdevDeviceType</title>
<indexterm zone="GUdevDeviceType-enum"><primary>GUdevDeviceType</primary></indexterm>
<programlisting>typedef enum {
  G_UDEV_DEVICE_TYPE_NONE = 0,
  G_UDEV_DEVICE_TYPE_BLOCK = 'b',
  G_UDEV_DEVICE_TYPE_CHAR = 'c',
} GUdevDeviceType;
</programlisting>
<para>
Enumeration used to specify a the type of a device.
</para><variablelist role="enum">
<varlistentry id="G-UDEV-DEVICE-TYPE-NONE:CAPS" role="constant">
<term><literal>G_UDEV_DEVICE_TYPE_NONE</literal></term>
<listitem><simpara>Device does not have a device file.
</simpara></listitem>
</varlistentry>
<varlistentry id="G-UDEV-DEVICE-TYPE-BLOCK:CAPS" role="constant">
<term><literal>G_UDEV_DEVICE_TYPE_BLOCK</literal></term>
<listitem><simpara>Device is a block device.
</simpara></listitem>
</varlistentry>
<varlistentry id="G-UDEV-DEVICE-TYPE-CHAR:CAPS" role="constant">
<term><literal>G_UDEV_DEVICE_TYPE_CHAR</literal></term>
<listitem><simpara>Device is a character device.
</simpara></listitem>
</varlistentry>
</variablelist></refsect2>
<refsect2 id="GUdevDeviceNumber" role="typedef">
<title>GUdevDeviceNumber</title>
<indexterm zone="GUdevDeviceNumber"><primary>GUdevDeviceNumber</primary></indexterm>
<programlisting>typedef guint64 GUdevDeviceNumber; /* __UQUAD_TYPE */
</programlisting>
<para>
Corresponds to the standard <link linkend="dev-t"><type>dev_t</type></link> type as defined by POSIX (Until
bug 584517 is resolved this work-around is needed).
</para></refsect2>
<refsect2 id="g-udev-client-new" role="function">
<title>g_udev_client_new ()</title>
<indexterm zone="g-udev-client-new"><primary sortas="client_new">g_udev_client_new</primary></indexterm>
<programlisting><link linkend="GUdevClient"><returnvalue>GUdevClient</returnvalue></link> *       g_udev_client_new                   (<parameter>const <link linkend="gchar"><type>gchar</type></link> * const *subsystems</parameter>);</programlisting>
<para>
Constructs a <link linkend="GUdevClient"><type>GUdevClient</type></link> object that can be used to query
information about devices. Connect to the <link linkend="GUdevClient-uevent"><type>"uevent"</type></link>
signal to listen for uevents. Note that signals are emitted in the
<link linkend="g-main-context-push-thread-default">thread-default main loop</link>
of the thread that you call this constructor from.
</para><variablelist role="params">
<varlistentry><term><parameter>subsystems</parameter>&#160;:</term>
<listitem><simpara>A <link linkend="NULL:CAPS"><literal>NULL</literal></link> terminated string array of subsystems to listen for uevents on, <link linkend="NULL:CAPS"><literal>NULL</literal></link> to not listen on uevents at all, or an empty array to listen to uevents on all subsystems. See the documentation for the <link linkend="GUdevClient--subsystems"><type>"subsystems"</type></link> property for details on this parameter. <emphasis role="annotation">[<acronym>array</acronym> zero-terminated=1][<acronym>element-type</acronym> utf8][<acronym>transfer none</acronym>][<acronym>allow-none</acronym>]</emphasis></simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>A new <link linkend="GUdevClient"><type>GUdevClient</type></link> object. Free with <link linkend="g-object-unref"><function>g_object_unref()</function></link>.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="g-udev-client-query-by-subsystem" role="function">
<title>g_udev_client_query_by_subsystem ()</title>
<indexterm zone="g-udev-client-query-by-subsystem"><primary sortas="client_query_by_subsystem">g_udev_client_query_by_subsystem</primary></indexterm>
<programlisting><link linkend="GList"><returnvalue>GList</returnvalue></link> *             g_udev_client_query_by_subsystem    (<parameter><link linkend="GUdevClient"><type>GUdevClient</type></link> *client</parameter>,
                                                         <parameter>const <link linkend="gchar"><type>gchar</type></link> *subsystem</parameter>);</programlisting>
<para>
Gets all devices belonging to <parameter>subsystem</parameter>.
</para><variablelist role="params">
<varlistentry><term><parameter>client</parameter>&#160;:</term>
<listitem><simpara>A <link linkend="GUdevClient"><type>GUdevClient</type></link>.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>subsystem</parameter>&#160;:</term>
<listitem><simpara>The subsystem to get devices for or <link linkend="NULL:CAPS"><literal>NULL</literal></link> to get all devices. <emphasis role="annotation">[<acronym>allow-none</acronym>]</emphasis></simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>A list of <link linkend="GUdevDevice"><type>GUdevDevice</type></link> objects. The caller should free the result by using <link linkend="g-object-unref"><function>g_object_unref()</function></link> on each element in the list and then <link linkend="g-list-free"><function>g_list_free()</function></link> on the list. <emphasis role="annotation">[<acronym>element-type</acronym> GUdevDevice][<acronym>transfer full</acronym>]</emphasis></simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="g-udev-client-query-by-device-number" role="function">
<title>g_udev_client_query_by_device_number ()</title>
<indexterm zone="g-udev-client-query-by-device-number"><primary sortas="client_query_by_device_number">g_udev_client_query_by_device_number</primary></indexterm>
<programlisting><link linkend="GUdevDevice"><returnvalue>GUdevDevice</returnvalue></link> *       g_udev_client_query_by_device_number
                                                        (<parameter><link linkend="GUdevClient"><type>GUdevClient</type></link> *client</parameter>,
                                                         <parameter><link linkend="GUdevDeviceType"><type>GUdevDeviceType</type></link> type</parameter>,
                                                         <parameter><link linkend="GUdevDeviceNumber"><type>GUdevDeviceNumber</type></link> number</parameter>);</programlisting>
<para>
Looks up a device for a type and device number.
</para><variablelist role="params">
<varlistentry><term><parameter>client</parameter>&#160;:</term>
<listitem><simpara>A <link linkend="GUdevClient"><type>GUdevClient</type></link>.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>type</parameter>&#160;:</term>
<listitem><simpara>A value from the <link linkend="GUdevDeviceType"><type>GUdevDeviceType</type></link> enumeration.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>number</parameter>&#160;:</term>
<listitem><simpara>A device number.</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>A <link linkend="GUdevDevice"><type>GUdevDevice</type></link> object or <link linkend="NULL:CAPS"><literal>NULL</literal></link> if the device was not found. Free with <link linkend="g-object-unref"><function>g_object_unref()</function></link>. <emphasis role="annotation">[<acronym>transfer full</acronym>]</emphasis></simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="g-udev-client-query-by-device-file" role="function">
<title>g_udev_client_query_by_device_file ()</title>
<indexterm zone="g-udev-client-query-by-device-file"><primary sortas="client_query_by_device_file">g_udev_client_query_by_device_file</primary></indexterm>
<programlisting><link linkend="GUdevDevice"><returnvalue>GUdevDevice</returnvalue></link> *       g_udev_client_query_by_device_file  (<parameter><link linkend="GUdevClient"><type>GUdevClient</type></link> *client</parameter>,
                                                         <parameter>const <link linkend="gchar"><type>gchar</type></link> *device_file</parameter>);</programlisting>
<para>
Looks up a device for a device file.
</para><variablelist role="params">
<varlistentry><term><parameter>client</parameter>&#160;:</term>
<listitem><simpara>A <link linkend="GUdevClient"><type>GUdevClient</type></link>.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>device_file</parameter>&#160;:</term>
<listitem><simpara>A device file.</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>A <link linkend="GUdevDevice"><type>GUdevDevice</type></link> object or <link linkend="NULL:CAPS"><literal>NULL</literal></link> if the device was not found. Free with <link linkend="g-object-unref"><function>g_object_unref()</function></link>. <emphasis role="annotation">[<acronym>transfer full</acronym>]</emphasis></simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="g-udev-client-query-by-sysfs-path" role="function">
<title>g_udev_client_query_by_sysfs_path ()</title>
<indexterm zone="g-udev-client-query-by-sysfs-path"><primary sortas="client_query_by_sysfs_path">g_udev_client_query_by_sysfs_path</primary></indexterm>
<programlisting><link linkend="GUdevDevice"><returnvalue>GUdevDevice</returnvalue></link> *       g_udev_client_query_by_sysfs_path   (<parameter><link linkend="GUdevClient"><type>GUdevClient</type></link> *client</parameter>,
                                                         <parameter>const <link linkend="gchar"><type>gchar</type></link> *sysfs_path</parameter>);</programlisting>
<para>
Looks up a device for a sysfs path.
</para><variablelist role="params">
<varlistentry><term><parameter>client</parameter>&#160;:</term>
<listitem><simpara>A <link linkend="GUdevClient"><type>GUdevClient</type></link>.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>sysfs_path</parameter>&#160;:</term>
<listitem><simpara>A sysfs path.</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>A <link linkend="GUdevDevice"><type>GUdevDevice</type></link> object or <link linkend="NULL:CAPS"><literal>NULL</literal></link> if the device was not found. Free with <link linkend="g-object-unref"><function>g_object_unref()</function></link>. <emphasis role="annotation">[<acronym>transfer full</acronym>]</emphasis></simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="g-udev-client-query-by-subsystem-and-name" role="function">
<title>g_udev_client_query_by_subsystem_and_name ()</title>
<indexterm zone="g-udev-client-query-by-subsystem-and-name"><primary sortas="client_query_by_subsystem_and_name">g_udev_client_query_by_subsystem_and_name</primary></indexterm>
<programlisting><link linkend="GUdevDevice"><returnvalue>GUdevDevice</returnvalue></link> *       g_udev_client_query_by_subsystem_and_name
                                                        (<parameter><link linkend="GUdevClient"><type>GUdevClient</type></link> *client</parameter>,
                                                         <parameter>const <link linkend="gchar"><type>gchar</type></link> *subsystem</parameter>,
                                                         <parameter>const <link linkend="gchar"><type>gchar</type></link> *name</parameter>);</programlisting>
<para>
Looks up a device for a subsystem and name.
</para><variablelist role="params">
<varlistentry><term><parameter>client</parameter>&#160;:</term>
<listitem><simpara>A <link linkend="GUdevClient"><type>GUdevClient</type></link>.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>subsystem</parameter>&#160;:</term>
<listitem><simpara>A subsystem name.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>name</parameter>&#160;:</term>
<listitem><simpara>The name of the device.</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>A <link linkend="GUdevDevice"><type>GUdevDevice</type></link> object or <link linkend="NULL:CAPS"><literal>NULL</literal></link> if the device was not found. Free with <link linkend="g-object-unref"><function>g_object_unref()</function></link>. <emphasis role="annotation">[<acronym>transfer full</acronym>]</emphasis></simpara></listitem></varlistentry>
</variablelist></refsect2>

</refsect1>
<refsect1 id="GUdevClient.property-details" role="property_details">
<title role="property_details.title">Property Details</title>
<refsect2 id="GUdevClient--subsystems" role="property"><title>The <literal>&quot;subsystems&quot;</literal> property</title>
<indexterm zone="GUdevClient--subsystems"><primary>GUdevClient:subsystems</primary></indexterm>
<programlisting>  &quot;subsystems&quot;               <link linkend="GStrv"><type>GStrv</type></link>                 : Read / Write / Construct Only</programlisting>
<para>
The subsystems to listen for uevents on.
</para>
<para>
To listen for only a specific DEVTYPE for a given SUBSYSTEM, use
"subsystem/devtype". For example, to only listen for uevents
where SUBSYSTEM is usb and DEVTYPE is usb_interface, use
"usb/usb_interface".
</para>
<para>
If this property is <link linkend="NULL:CAPS"><literal>NULL</literal></link>, then no events will be reported. If
it's the empty array, events from all subsystems will be
reported.
</para></refsect2>

</refsect1>
<refsect1 id="GUdevClient.signal-details" role="signals">
<title role="signals.title">Signal Details</title>
<refsect2 id="GUdevClient-uevent" role="signal"><title>The <literal>&quot;uevent&quot;</literal> signal</title>
<indexterm zone="GUdevClient-uevent"><primary>GUdevClient::uevent</primary></indexterm>
<programlisting><link linkend="void"><returnvalue>void</returnvalue></link>                user_function                      (<link linkend="GUdevClient"><type>GUdevClient</type></link> *client,
                                                        <link linkend="gchar"><type>gchar</type></link>       *action,
                                                        <link linkend="GUdevDevice"><type>GUdevDevice</type></link> *device,
                                                        <link linkend="gpointer"><type>gpointer</type></link>     user_data)      : <link linkend="G-SIGNAL-RUN-LAST:CAPS"><literal>Run Last</literal></link></programlisting>
<para>
Emitted when <parameter>client</parameter> receives an uevent.
</para>
<para>
This signal is emitted in the
<link linkend="g-main-context-push-thread-default">thread-default main loop</link>
of the thread that <parameter>client</parameter> was created in.
</para><variablelist role="params">
<varlistentry><term><parameter>client</parameter>&#160;:</term>
<listitem><simpara>The <link linkend="GUdevClient"><type>GUdevClient</type></link> receiving the event.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>action</parameter>&#160;:</term>
<listitem><simpara>The action for the uevent e.g. "add", "remove", "change", "move", etc.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>device</parameter>&#160;:</term>
<listitem><simpara>Details about the <link linkend="GUdevDevice"><type>GUdevDevice</type></link> the event is for.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>user_data</parameter>&#160;:</term>
<listitem><simpara>user data set when the signal handler was connected.</simpara></listitem></varlistentry>
</variablelist></refsect2>
</refsect1>

</refentry>
